---
import Layout from "../layouts/Layout.astro";
import ProductCard from "../components/ProductCard.astro";
import Products from '../data/Products.json'

const {products} = Products
const categories = [...new Set(products.map(product => product.category))]

function getProductsByCategory(category: string) {
    return products.filter(product => product.category === category)
}
---

<Layout>
    <main>
        <h1>Nuestros productos</h1>
        <nav class="categories-nav">
            {categories.map(category => (
                <a href={`#${category?.toLowerCase().replace(/\s+/g, '-')}`} class="category-links">
                    {category}
                </a>
            ))}
        </nav>

        {categories.map(category => (
            <section id={category?.toLowerCase().replace(/\s+/g, '-')} class="category-section">
                <h2>{category}</h2>
                <div class="product-grid">
                    {getProductsByCategory(category).map(product => (
                        <ProductCard {...product} />
                    ))}
                </div>
            </section>
        ))}
    </main>
</Layout>

<style>
    main{
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;

        h1{
            text-align: center;
            color: #fff;
            margin-bottom: 2rem;
            font-size: 2.5rem;
            text-shadow: 2px 2px 4px rgba(0 0 0 0.3);
        }
        .categories-nav{
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 3rem;
            padding: 1rem;
            background: var(--glass-background);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--galss-border);
            border-radius: 8px;
            box-shadow: var(--glass-shadow);

            .category-links{
                color: #fff;
                text-decoration: none;
                padding: 0.5rem 1rem;
                border-radius: 4px;
                transition: background-color 0.2;
                background: rgba(255 255 255 0.1);

                &:hover{
                    background: rgba(255 255 255 0.2);
                }
            }
        }
        .category-section{
            margin-bottom: 4rem;
            scroll-margin-top: 100px;

            h2{
                color: #fff;
                font-size: 2rem;
                margin-bottom: 2rem;
                padding-bottom: 0.5rem;
                border-bottom: 2px solid rgba(255 255 255 0.2);
                text-shadow: 2px 2px 4px rgba(0 0 0 0.3);
            }
            .product-grid{
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
                gap: 2rem;
                padding: 1rem;
            }
        }

        @media (max-width:768px) {
            .categories-nav{
                flex-direction: column;
                align-items: stretch;
                padding: 0.5rem;

                .category-links{
                    text-align: center;
                }
            }
            .product-grid{
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 1rem;
            }
            .category-section{
                scroll-margin-top: 80px;
            }
        }
    }
</style>